# 	SOC102 - Proxy - Suspicious URL Detected (Event ID:32)


## Executive Summary

On December 1, 2020, the Security Operations Center (SOC) received an alert for a "Suspicious URL Detected" originating from the host **MikeComputer** (172.148.17.14). The investigation confirmed that the user's browser was attempting to load an image from **`encrypted-tbn0.gstatic.com`**, a legitimate Google-owned domain used for serving cached image content for Google Search results. The URL itself resolves to a harmless image. The alert was triggered by a security control that incorrectly flagged this benign activity. The **Device Action** was **Blocked**, indicating the user was prevented from seeing the image, but this was due to a misconfiguration, not a real threat. The alert is a **False Positive**.

## Incident Details

The initial alert was triggered by a request to a legitimate Google content delivery network:

<img width="1460" height="533" alt="image" src="https://github.com/user-attachments/assets/e75c849c-1c2b-4139-a4ad-63cbb97cb42f" />

| | |
| :--- | :--- |
| **Date of Incident**| December 1, 2020 |
| **Source Host**| MikeComputer (172.148.17.14) |
| **Username**| Mike01 |
| **Destination Host**| encrypted-tbn0.gstatic.com (172.217.17.174) |
| **Request URL**| `https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSjESkzn2LUxELhnqZZWBbmGwtbqfFsaemB9w&usqp=CAU` |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/32))* |

## Investigation and Analysis

### 1. Alert Triage and Contextual Analysis

The investigation began by analyzing the destination hostname, `encrypted-tbn0.gstatic.com`.
*   **Domain Context:** `gstatic.com` is a well-known, legitimate domain owned by Google. It is a Content Delivery Network (CDN) used to host static content like images (`tbn` likely stands for thumbnail), CSS, and JavaScript to speed up Google services, particularly Google Image Search. Traffic to this domain is extremely common and almost always benign.
*   **User Agent:** The `User-Agent` indicates the user was browsing from an iPhone (`iPhone OS 13_4_1`), which is normal user activity.

### 2. Threat Intelligence and Log Analysis

The investigation found no evidence of malicious activity.
*   **Threat Intelligence (VirusTotal):** A check of the full URL on VirusTotal showed **zero detections**. This strongly supports the conclusion that the link is safe.
    <img width="1688" height="842" alt="image" src="https://github.com/user-attachments/assets/7cff5c71-0a2c-4711-a746-3df85661e1b1" />
*   **Content Analysis:** Accessing the URL reveals that it is simply a cached image of a cliff on a beach.
    <img width="537" height="370" alt="image" src="https://github.com/user-attachments/assets/e0487914-0cba-4197-b09a-59192f780c8e" />
*   **Log Confirmation:** Proxy logs confirm the GET request from the user's `chrome.exe` process. The **`Device Action: Blocked`** is the most notable part of this log. It indicates that a security control (likely a web proxy or filter) incorrectly flagged this legitimate traffic and prevented the user from loading the image.
    <img width="948" height="422" alt="image" src="https://github.com/user-attachments/assets/f1dec012-666f-4822-a1d4-d5b2-2f2f288cb" />

### 3. Final Assessment

All evidence confirms this was a benign event. A user's browser attempted to load a standard image from Google's CDN. The SIEM rule and the web filter both generated a false positive, likely due to a poorly configured rule that may be flagging all traffic to certain CDNs or based on a flawed reputation score.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, Proxy Logs, VirusTotal
*   **Skills Demonstrated:** False Positive Analysis, Contextual Triage, Understanding of CDNs.

## Playbook Solution: Incident Classification

*   **Analyze URL:** **Non-malicious.** The URL is for a benign image on a Google CDN.
*   **Incident Classification:** **False Positive.**

## Conclusion and Recommendations

The alert for SOC102 was a **false positive**. The investigation confirmed that a user was attempting to load a harmless image as part of normal web browsing. The alert was generated by a misconfigured or overly sensitive detection rule, which also led to a security control incorrectly blocking legitimate traffic.

**Recommendations:**

1.  **Close Alert:** The alert should be closed as a False Positive, with a note detailing the findings.
2.  **Rule Tuning and Whitelisting:** This event highlights a clear need for tuning.
    *   The SOC team should review the logic for the `SOC102` rule.
    *   A broad exception or "allowlist" should be created for well-known, high-traffic Google domains like `*.gstatic.com` in both the SIEM detection rule and the web proxy's block rules. This will prevent future false positives and will stop the disruption of normal user activity.






















