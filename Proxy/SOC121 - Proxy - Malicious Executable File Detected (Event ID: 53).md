# SOC121 - Proxy - Malicious Executable File Detected (Event ID 53)

## Executive Summary

On February 7, 2021, the Security Operations Center (SOC) received an alert for an attempted download of a malicious executable file by the user `Susie` on the host **SusieHost** (172.16.17.5). The investigation confirmed that the user's browser attempted to download an executable (`pianificazione.exe`) from a suspicious, long-string domain (`gavrilobtcapikey2884238984928.netsons.org`), a common characteristic of malware hosting sites. Threat intelligence confirmed the malicious nature of the domain. The network proxy or web filter successfully identified the threat, and the **Device Action** was **Blocked**. This is a **True Positive** for a real threat, but the attack was **unsuccessful** as the malicious file was prevented from reaching the endpoint.

## Incident Details

The initial alert was triggered by a user's browser attempting to download an executable from a malicious domain:

<img width="1454" height="530" alt="image" src="https://github.com/user-attachments/assets/7d67a9c5-13da-4df2-84b9-b1c3c844140b" />

| | |
| :--- | :--- |
| **Date of Incident**| February 7, 2021 |
| **Source Host**| SusieHost (172.16.17.5) |
| **Username**| Susie |
| **Destination Host**| `gavrilobtcapikey2884238984928.netsons.org` (89.40.172.121) |
| **Malicious File**| `pianificazione.exe` |
| **Attack Type**| Malware Download |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/53))* |

## Investigation and Analysis

### 1. Alert Triage and Log Analysis

The investigation began by analyzing the alert details, which pointed to a clear attempt to download malware.
*   **Malicious Domain:** The destination hostname, `gavrilobtcapikey2884238984928.netsons.org`, is highly suspicious. The long, randomized-looking subdomain is a classic indicator of a domain generated by a Domain Generation Algorithm (DGA) or a temporary malware hosting site.
*   **Malicious File:** The requested URL points directly to an executable file, `pianificazione.exe`. Unsolicited downloads of executables are a major red flag.
*   **Log Confirmation:** A review of the proxy logs confirms that the user's `chrome.exe` process made a GET request for the malicious executable.
    <img width="1208" height="422" alt="image" src="https://github.com/user-attachments/assets/dee162d2-7f11-41a8-a11a-a337a67a7f76" />

### 2. Threat Intelligence

An analysis of the destination hostname on VirusTotal confirmed its malicious reputation, with 3 security vendors flagging it. While a low number, any detection for a domain hosting an executable is a strong indicator of malicious intent.

<img width="1751" height="670" alt="image" src="https://github.com/user-attachments/assets/c06b9502-9e20-48bf-9993-98a81f43df3b" />

### 3. Confirmation of Successful Prevention

The most critical finding of this investigation is that the attack was prevented. The **`Device Action: Blocked`** status, present in both the SIEM alert and the detailed log entry, is the definitive piece of evidence. This confirms that the corporate web proxy or security gateway correctly identified the request as malicious and blocked the download. The `pianificazione.exe` file never reached the user's computer.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, Proxy Logs, VirusTotal
*   **Skills Demonstrated:** Malware Triage, Threat Intelligence Correlation, Log Analysis.

## Playbook Solution: Incident Classification

*   **Analyze URL:** **Malicious.** The URL points to an executable on a suspicious domain.
*   **Was the Attack Successful?** **No.** The download was blocked by the web proxy.
*   **Do You Need Tier 2 Escalation?** **No.** The threat was successfully neutralized by an automated control.
*   **Incident Classification:** **True Positive.** (The alert correctly identified an attempted malware download).

## Conclusion and Recommendations

The alert for SOC121 was a **true positive**. A user attempted to download a malicious executable from a known-bad domain. The investigation confirms the malicious nature of the request but, most importantly, confirms that the download was successfully **blocked** by the web proxy. No systems were compromised.

**Recommendations:**

1.  **Acknowledge Prevention:** Note the successful prevention by the web proxy/filter.
2.  **Close Alert:** The alert can be closed as a True Positive, with the outcome noted as "Blocked" or "Prevented."
3.  **Investigate Initial Vector:** The critical follow-up action is to determine *why* the user's browser attempted to download this file. An interview with the user (`Susie`) is necessary to investigate the root cause. Did they click a link in a phishing email? Were they redirected from a compromised website? Understanding the initial vector is key to preventing future incidents.
4.  **BLOCK INDICATORS:** As a proactive measure, ensure the destination hostname (`gavrilobtcapikey2884238984928.netsons.org`) and its IP (`89.40.172.121`) are permanently on all relevant blocklists.




















