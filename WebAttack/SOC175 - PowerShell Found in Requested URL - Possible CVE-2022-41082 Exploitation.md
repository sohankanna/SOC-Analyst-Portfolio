# SOC175 - PowerShell Found in Requested URL - Possible CVE-2022-41082 Exploitation

## Executive Summary

On September 30, 2022, the Security Operations Center (SOC) received an alert for a possible exploitation of a critical Microsoft Exchange Server vulnerability, **CVE-2022-41082**, targeting **Exchange Server 2** (172.16.20.8). The attack originated from the IP address **58.237.200.6** and used a specially crafted URL attempting to trigger remote PowerShell execution via the Autodiscover service. Log analysis confirmed multiple exploit attempts from the source IP, all of which were successfully **Blocked** by security controls, likely a Web Application Firewall (WAF). The incident is a **True Positive** for a malicious exploit attempt, but the attack was **unsuccessful**, and no systems were compromised.
<img width="1460" height="572" alt="image" src="https://github.com/user-attachments/assets/3bf560a0-5de7-4325-a575-60838716e081" />

## Incident Details

The initial alert was triggered by a URL pattern matching a known Exchange exploit:

⭐ *This zero-day vulnerability (CVE-2022-41082) is being actively exploited in the wild.*

| | |
| :--- | :--- |
| **Date of Incident** | September 30, 2022 |
| **Source IP Address** | 58.237.200.6 |
| **Destination Host** | Exchange Server 2 (172.16.20.8) |
| **Attack Type** | Web Exploit (CVE-2022-41082 Attempt) |
| **Malicious Payload** | `/autodiscover/autodiscover.json?@evil.com/owa/&...&FooProtocol=Powershell` |
| **Case Link** | (https://app.letsdefend.io/case-management/casedetail/sohankanna/125) |

## Investigation and Analysis

### 1. Payload and Vulnerability Analysis

The `Request URL` is a clear indicator of an attempt to exploit CVE-2022-41082, a Remote Code Execution (RCE) vulnerability in Microsoft Exchange. The key components are:
*   **Targeting Autodiscover:** The attacker targets the `/autodiscover/autodiscover.json` endpoint, a known entry point for this exploit chain.
*   **PowerShell String:** The inclusion of `&FooProtocol=Powershell` is the explicit attempt to abuse a feature to gain remote PowerShell access on the server.
*   **Automated Scanner:** The User-Agent `Mozilla/5.0 zgrab/0.x` is not a standard web browser. `zgrab` is an application and network scanner, confirming this was an automated, non-targeted scan looking for vulnerable servers.

### 2. Log Analysis and Confirmation of Failure

A review of the IIS logs for the source IP `58.237.200.6` showed three distinct but related attempts to trigger the vulnerability.

<img width="636" height="258" alt="image" src="https://github.com/user-attachments/assets/a39d1c3e-41ce-4993-b737-b9921c562b7d" />
<img width="644" height="281" alt="image" src="https://github.com/user-attachments/assets/403bd269-95b9-44b3-ad6e-b14407aea7a8" />
<img width="649" height="224" alt="image" src="https://github.com/user-attachments/assets/eac134a4-7f5d-428a-ac23-c7b899aa6e6f" />

Critically, for all three attempts, the **Device Action** was **Blocked**. This provides definitive proof that the malicious requests never reached the vulnerable application component. The WAF or a similar network security appliance successfully identified and dropped the traffic, preventing the attack.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, IIS Logs
*   **Skills Demonstrated:** Web Attack Analysis, Exploit Attempt Recognition, Vulnerability Triage (CVE-2022-41082), Log Analysis.

## Playbook Solution: Incident Classification

*   **Is Traffic Malicious?** **Yes.** It was a clear attempt to exploit a known RCE vulnerability.
*   **What Is The Attack Type?** **Web Exploit.**
*   **What Is the Direction of Traffic?** **Internet → Company Network.**
*   **Was the Attack Successful?** **No.** All malicious requests were blocked by security controls.
*   **Do You Need Tier 2 Escalation?** **No.** The threat was successfully neutralized by an automated defense.
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC175 was a **true positive** for an automated attempt to exploit the CVE-2022-41082 vulnerability on an external-facing Exchange server. The investigation confirms that the organization's perimeter security defenses, likely the WAF, functioned correctly and blocked all attempts. No compromise occurred.

**Recommendations:**

1.  **Acknowledge Prevention:** Note the successful prevention by the WAF. This is a good indicator of a healthy security posture.
2.  **Verify Patching:** Although the attack was blocked, it is critical to confirm that **Exchange Server 2** is fully patched against CVE-2022-41082 and other related vulnerabilities (e.g., ProxyNotShell). The exploit attempt serves as a warning that the server is being actively targeted.
3.  **Block Malicious IP:** Add the source IP address `58.237.200.6` to the network firewall's blocklist to prevent it from conducting further scans or attacks.
4.  **Review WAF Signatures:** Ensure that the WAF signatures responsible for blocking this attack are up-to-date to protect against future variants of this exploit.
