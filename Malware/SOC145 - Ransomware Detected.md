# SOC145: Analysis of a Ransomware Attack

## Executive Summary

On May 23 2021, the Security Operations Center (SOC) received a critical SIEM alert for a ransomware attack on the host **MarkPRD** (172.16.17.88). The malicious file, **ab.exe**, with MD5 hash **0b486fe0503524cfe4726a4022fa6a68**, was confirmed to be a variant of the **Avaddon ransomware**. Threat intelligence from VirusTotal and dynamic analysis from the AnyRun sandbox confirmed the file's malicious nature. The malware exhibited classic ransomware behavior, including encrypting files, deleting volume shadow copies to inhibit system recovery, and modifying UAC settings to gain higher privileges. The incident is a **True Positive** and requires immediate escalation to the Incident Response team for containment and eradication.

## Incident Details

The initial alert was received from the SIEM dashboard:

![](https://miro.medium.com/v2/resize:fit:700/1*WpAe_lKa_-vnG7VUiNNrUQ.png)

| | |
| :--- | :--- |
| **Date of Incident** | May 23, 2021 |
| **Source Host** | MarkPRD (172.16.17.88) |
| **File Name** | ab.bin.exe |
| **File Hash (MD5)** | 0b486fe0503524cfe4726a4022fa6a68 |
| **Malware Family** | Avaddon Ransomware |
| **Case Link** | [View Full Case on LetsDefend.io](https://app.letsdefend.io/case-management/casedetail/sohankanna/92) |

## Investigation and Analysis

### 1. Initial Triage & Threat Intelligence

The file's MD5 hash was checked against VirusTotal, which returned a high number of detections, confirming it was a well-known malicious file.

![](https://miro.medium.com/v2/resize:fit:700/1*rJrTNSBVa_KWmhTO-iDaPA.png)

The "Relations" tab in VirusTotal listed IP addresses associated with the malware, which are potential command-and-control (C2) servers.

![](https://miro.medium.com/v2/resize:fit:700/1*Nron-NwKqZ_4avx_7NHavg.png)

A query of the logs for traffic between the victim host (MarkPRD) and these IPs showed no successful connections.

![](https://miro.medium.com/v2/resize:fit:700/1*L0_FNgQYUXD_a4pj3kETqA.png)

### 2. Behavioral Analysis (Sandbox)

To get a definitive understanding of the file's behavior, the hash was submitted to the AnyRun sandbox. The analysis confirmed the malicious verdict.

![](https://miro.medium.com/v2/resize:fit:700/1*F-RwCJC79LkfafN0n59GEA.png)

A detailed review of the sandbox report for the **ab.bin.exe** process revealed several malicious activities mapped to the MITRE ATT&CK framework.

![](https://miro.medium.com/v2/resize:fit:700/1*4hNGEiAEoEw8B_7BZ89XaA.png)

The key takeaways from the process analysis were:

![](https://miro.medium.com/v2/resize:fit:607/1*UiF9_qJlUSNK7q1pDBKsuw.png)

*   **T1486 Data Encrypted for Impact:** The malware was observed actively renaming files, which is characteristic of ransomware encrypting user data.
*   **T1490 Inhibit System Recovery:** It executed commands to **delete shadow copies**, a common tactic to prevent users from restoring their files using Windows' built-in recovery features.
*   **T1562.001 Disable or Modify Tools:** The process attempted to modify **UAC/LUA settings**, a defense evasion technique used to perform actions with higher privileges without user consent.
*   **Hidden C2 Capability:** A YARA rule detected a **XORed (obfuscated) URL** within the file. This is likely the address of its C2 server, indicating that the malware is designed for C2 communication even if none was observed in the logs.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, VirusTotal, AnyRun (Sandbox)
*   **Skills Demonstrated:** Log Analysis, Threat Intelligence Correlation, Sandboxing, Behavioral Malware Analysis, MITRE ATT&CK Framework Mapping.

## Playbook Solution: Incident Classification

*   **Is the File Malicious?** **Yes.** It is a confirmed variant of the Avaddon ransomware.
*   **What Is the Attack Type?** **Ransomware.**
*   **Was the Attack Successful?** **Yes.** The file executed on the host and began its malicious payload (encrypting files, deleting backups).
*   **Do You Need Tier 2 Escalation?** **Yes. This is a critical incident.** It requires immediate escalation to a Tier 2/3 Incident Response team for full-scale containment and recovery.
*   **Incident Classification:** **True Positive.** The alert correctly identified a severe and active threat in the environment.

## Conclusion and Recommendations

The alert for SOC145 is a **true positive** for an active ransomware infection on the host MarkPRD. Dynamic analysis confirmed the file is a variant of the Avaddon ransomware and has already begun encrypting files and destroying system recovery points. This is a critical security incident that requires an immediate and decisive response.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host Immediately:** Disconnect **MarkPRD** from the network (unplug the ethernet cable, disable the virtual network adapter) to prevent the ransomware from spreading to other systems or network shares.
2.  **ESCALATE - Activate Incident Response Protocol:** Immediately escalate this incident to the Tier 2/Incident Response (IR) team.
3.  **ERADICATION - Re-image the Host:** The compromised machine should not be trusted. It must be re-imaged from a known good source after the investigation is complete.
4.  **RECOVERY - Initiate Backup Recovery:** Identify the latest clean backups for the data on MarkPRD. **Do not pay the ransom.**
5.  **BLOCK INDICATORS:** Add the file hash `0b486fe0503524cfe4726a4022fa6a68` and any associated C2 domains/IPs to the organization's blocklists (EDR, firewall, proxy).
