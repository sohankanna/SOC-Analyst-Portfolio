#	SOC126 - Suspicious New Autorun Value Detected

## Executive Summary

On February 14, 2021, the Security Operations Center (SOC) detected the creation of a suspicious autorun value on the host **KatharinePRD** (172.16.15.78). The investigation confirmed this action was performed by a malicious executable, `OliwciaPrivInstaller.exe`, identified as the **Quasar Remote Access Trojan (RAT)**. Dynamic analysis shows the malware's primary function is to establish persistence by creating a registry autorun key and then provide an attacker with full remote control over the victim's machine. The alert details and endpoint logs confirm that the endpoint security solution successfully detected this malicious behavior and **Cleaned** the threat, preventing any command-and-control (C2) communication. This is a **True Positive** for a real, albeit prevented, threat.

## Incident Details

The initial alert was triggered by the malware's attempt to create a persistence mechanism:

<img width="1496" height="568" alt="image" src="https://github.com/user-attachments/assets/11b3eb3c-3f1f-4ca3-9ba2-5069642ffd27" />

| | |
| :--- | :--- |
| **Date of Incident**| February 14, 2021 |
| **Attacker C2**| `jebacdisaskurwysyna-33409.portmap.io:33409` |
| **Destination Host**| KatharinePRD (172.16.15.78) |
| **Malware File**| OliwciaPrivInstaller.exe |
| **File Hash (MD5)**| 436fa243bbfed63a99b8e9f866cd80e5 |
| **Malware Family**| Quasar RAT |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/61))* |

## Investigation and Analysis

### 1. Alert Context: Autorun Keys as a Persistence TTP

The rule `SOC126 - Suspicious New Autorun Value Detected` is designed to detect a critical persistence technique (MITRE ATT&CK T1547.001 - Registry Run Keys). Attackers add their malware to these specific registry locations to ensure their program automatically executes every time the user logs in, thus surviving a system reboot. While some legitimate installers use this, it is highly indicative of malware.

### 2. Malware Analysis (Quasar RAT)

Threat intelligence and dynamic analysis provided a definitive identification of the malware.
*   **Threat Intelligence:** VirusTotal confirmed the file is malicious with **59 security vendors** flagging it.
*   **Dynamic Analysis (Any.Run):** A sandbox run provided deep insight into the malware's identity and behavior.
    *   **Identification:** The malware was positively identified as **Quasar RAT**, a popular, open-source Remote Access Trojan. Being open-source makes it easily accessible and customizable for many different threat actors.
    *   **Capabilities:** As a RAT, Quasar provides an attacker with a comprehensive set of remote control capabilities, including keylogging, password theft, webcam access, file system browsing, and remote command execution.
    *   **Observed Behaviors:** The sandbox confirmed the malware's malicious actions, which directly correlate with the alert:
        *   **Changes the autorun value in the registry** (the action that triggered the alert).
        *   Drops copies of itself to other locations.
        *   Performs reconnaissance (reads internet settings, computer name, checks for external IP).
        *   Executes commands via `cmd.exe`.

### 3. Confirmation of Successful Prevention

The investigation confirmed that while a real threat was present, the security controls successfully prevented a full compromise.
*   **Device Action: Cleaned:** The initial alert itself states that the EDR/antivirus agent took a "Cleaned" action. This means the malicious file was detected and removed or quarantined.
*   **Endpoint Log Verification:** A review of the endpoint security logs for the host "KatharinePRD" shows no active malicious processes related to this incident. This corroborates the "Cleaned" status.
    <img width="1167" height="475" alt="image" src="https://github.com/user-attachments/assets/705b2064-345a-4eaa-9a64-675882238be0" />
*   **Network Log Verification:** A search of the network logs showed no outbound connections from the host to the Quasar RAT's hardcoded C2 server (`jebacdisaskurwysyna-33409.portmap.io`). This is a critical finding, as it proves the EDR agent stopped the malware **before** it could establish a connection with the attacker.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, VirusTotal, Any.Run
*   **Skills Demonstrated:** Malware Analysis (RAT), Persistence Technique Triage, Log Correlation, Threat Intelligence Synthesis.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Malicious.** The file is the Quasar RAT.
*   **Was Malware Quarantined/Cleaned?** **Yes.** The device action was "Cleaned."
*   **Was C2 Requested?** **No, Not Accessed.** The malware was stopped before it could make outbound connections.
*   **Incident Classification:** **True Positive.** (A real threat was detected and stopped).

## Conclusion and Recommendations

The alert for SOC126 was a **true positive**. The host "KatharinePRD" was infected with the Quasar RAT, which attempted to establish persistence by creating a new autorun value in the registry. The endpoint security solution successfully detected this malicious behavior, cleaned the malware, and prevented it from establishing a connection with its C2 server. The host was protected from a full remote takeover.

**Recommendations:**

1.  **Acknowledge Prevention:** Note the successful detection and remediation by the EDR/antivirus solution.
2.  **Verify Containment:** Although the EDR reported "Cleaned," a best practice is to have a Tier 2 analyst or system administrator perform a verification. This includes running a full AV scan on the host and manually checking the registry to ensure the malicious autorun key was successfully removed.
3.  **Investigate Initial Access:** The most critical follow-up action is to determine *how* `OliwciaPrivInstaller.exe` was executed on the host in the first place. An interview with the user (`Katharine`) is necessary to investigate potential phishing emails, malicious downloads from the web, or other initial access vectors. This is key to preventing recurrence.
4.  **BLOCK INDICATORS:** Proactively block the C2 domain (`jebacdisaskurwysyna-33409.portmap.io`) and the file hash (`436fa243bbfed63a99b8e9f866cd80e5`) at the network perimeter (firewall/proxy) and in the EDR to protect other hosts.```
