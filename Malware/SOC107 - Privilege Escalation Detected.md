# 	SOC107 - Privilege Escalation Detected
## Executive Summary

On January 31, 2021, the Security Operations Center (SOC) detected a critical privilege escalation event on the host **RichardPRD** (172.16.17.45). The investigation confirmed the execution of **JuicyPotato.exe**, a well-known hacking tool used to escalate privileges from a local service account to the highest level, **NT AUTHORITY\SYSTEM**. The `Device Action: Allowed` confirms that endpoint security controls did not prevent the execution of this dangerous tool. Although no immediate command-and-control (C2) traffic was observed, the successful execution of this exploit means the host is fully compromised, and the attacker now has complete control. This is a **True Positive** for a critical security breach and requires immediate incident response.

## Incident Details

The initial alert was triggered by the execution of a known privilege escalation tool:

<img width="1503" height="597" alt="image" src="https://github.com/user-attachments/assets/d7d2ae74-2b86-4ebd-a46a-12349f9b6a85" />

| | |
| :--- | :--- |
| **Date of Incident**| January 31, 2021 |
| **Source Host**| RichardPRD (172.16.17.45) |
| **Tool Name**| JuicyPotato.exe |
| **File Hash (MD5)**| 808502752ca0492aca995e9b620d507b |
| **Attack Type**| Local Privilege Escalation |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/48))* |

## Investigation and Analysis

### 1. Tool Profile: JuicyPotato

**JuicyPotato** is a powerful and widely used local privilege escalation tool for Windows. It is not malware in the sense of a virus or worm, but a hacking utility that attackers deploy *after* they have already gained initial access to a machine with low-level privileges.

*   **How it Works:** It exploits the way Windows handles DCOM/RPC requests. An attacker running as a low-privileged service account (like `NETWORK SERVICE` or `LOCAL SERVICE`), which often have `SeImpersonatePrivilege`, can use JuicyPotato to trick a high-privileged DCOM server into connecting back to a listener controlled by the tool. JuicyPotato then intercepts this connection and hijacks the high-privileged security token, which it can use to create a new process (like `cmd.exe`) that runs as **NT AUTHORITY\SYSTEM**.
*   **Common Use Case:** Attackers who gain initial access via a vulnerable web server (which often runs as a low-privileged service account) will use JuicyPotato as their next step to gain full control of the server.
*   **Impact:** Gaining SYSTEM-level privileges is the "keys to the kingdom" on a Windows host. An attacker with SYSTEM access can disable security software, dump credentials from memory (using tools like Mimikatz), install persistent backdoors, and use the compromised machine to launch attacks against other systems on the network.

### 2. Threat Intelligence and Confirmation of Malicious Intent

The tool's identity and purpose were confirmed by multiple sources.
*   **VirusTotal:** The hash `808502752ca0492aca995e9b620d507b` was flagged as malicious or a hacking tool by **60 security vendors**. This confirms the file is not a legitimate system tool and its presence is a definitive indicator of compromise.
    <img width="1750" height="851" alt="image" src="https://github.com/user-attachments/assets/aaeeae1c-5e7d-44c2-af72-68e9415bbf77" />

### 3. Confirmation of Execution and Impact

The investigation confirmed that the tool was successfully executed on the target host.
*   **Device Action: Allowed:** The SIEM alert clearly indicates that the EDR/antivirus agent did not block the execution of `JuicyPotato.exe`. This means the privilege escalation attempt was successful.
*   **Network Logs:** While a search of the logs showed no *new* external C2 connections at the time of the alert, this is expected behavior for JuicyPotato itself. It is a local tool used to elevate privileges; the attacker would use their newly acquired SYSTEM access to establish a more persistent C2 channel *after* running the tool. The absence of immediate C2 traffic does not diminish the severity of the incident.
    <img width="1426" height="631" alt="image" src="https://github.com/user-attachments/assets/a1b209b5-2dfb-4cb3-aadc-fd5101fd02ac" />

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, VirusTotal
*   **Skills Demonstrated:** Privilege Escalation Analysis, Hacking Tool Identification, Log Correlation.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Malicious.** The file is a known privilege escalation hacking tool.
*   **Was Malware Quarantined?** **No.** The `Device Action` was `Allowed`.
*   **Was C2 Requested?** **Not Accessed** (by this specific tool, but post-exploitation C2 is expected).
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC107 was a **true positive** for a critical and successful local privilege escalation attack. An attacker, having already gained initial access, deployed and executed the JuicyPotato tool to elevate their privileges to NT AUTHORITY\SYSTEM. The host **RichardPRD** is fully compromised and under attacker control. This represents a severe threat, as the attacker can now use this high level of access to achieve their ultimate objectives.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host Immediately:** Disconnect the host **RichardPRD** (172.16.17.45) from the network to prevent the attacker from using their elevated privileges for lateral movement or data exfiltration.
2.  **ESCALATE:** Immediately escalate this incident to the Tier 2/Incident Response (IR) team for a full forensic investigation.
3.  **INVESTIGATION:** This is now a two-part investigation:
    *   **Initial Access:** The IR team must determine *how* the attacker gained their initial low-privileged access to run JuicyPotato. This involves analyzing web server logs, phishing email records, etc.
    *   **Post-Escalation Activity:** The team must perform a full forensic analysis of the host to determine what the attacker did *after* gaining SYSTEM privileges. This includes searching for credential dumping, new services or scheduled tasks, and any outbound C2 connections.
4.  **CREDENTIALS - Assume Full Compromise:** All credentials (user passwords, service account passwords, etc.) on the compromised host must be considered stolen and must be reset.
5.  **RECOVERY:** The compromised host cannot be trusted and must be wiped and re-imaged from a known-good source.
6.  **BLOCK INDICATORS:** Add the file hash (`808502752ca0492aca995e9b620d507b`) to the EDR blocklist.

