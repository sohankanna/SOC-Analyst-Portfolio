# 	SOC139 - Meterpreter or Empire Activity

# SOC139: Analysis of a Successful Cobalt Strike Beacon Implant

## Executive Summary

On March 15, 2021, the Security Operations Center (SOC) received a high-severity alert for activity associated with post-exploitation frameworks like Meterpreter or Empire on the host **Alex - HP** (172.16.17.55). The investigation confirmed the execution of a malicious file named `cobaltstrike_shellcode.exe`, identified as a **Cobalt Strike Beacon**. Endpoint and network logs provide definitive proof that the malware was **Allowed** to run and successfully established a command-and-control (C2) connection to a known malicious server (`120.79.181.138`). The host is actively compromised and under attacker control. This is a **True Positive** for a critical security breach.

## Incident Details

The initial alert was triggered by signatures or behaviors associated with common attack frameworks:

<img width="1522" height="591" alt="image" src="https://github.com/user-attachments/assets/9be72a50-9038-414e-9884-e18e6ebcf62d" />

| | |
| :--- | :--- |
| **Date of Incident**| March 15, 2021 |
| **Attacker C2 IP**| 120.79.181.138 |
| **Destination Host**| Alex - HP (172.16.17.55) |
| **Malware File**| cobaltstrike_shellcode.exe |
| **File Hash (MD5)**| 24d99ba5654cdf31141c66fd9417b7e0 |
| **Malware Family / Tool**| Cobalt Strike Beacon |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/78))* |

## Investigation and Analysis

### 1. Alert Context: Post-Exploitation Frameworks (Meterpreter, Empire, Cobalt Strike)

The rule `SOC139 - Meterpreter or Empire Activity` is designed to detect some of the most powerful and commonly abused tools in an attacker's arsenal.
*   **Meterpreter:** The primary payload of the Metasploit Framework, it provides an attacker with an interactive, in-memory shell on a victim's machine, allowing for stealthy post-exploitation.
*   **Empire:** A PowerShell-based framework that is highly effective for "living-off-the-land" attacks within Windows environments.
*   **Cobalt Strike:** A commercial, high-end penetration testing tool that has been widely adopted by both red teams and malicious threat actors (especially ransomware groups). Its implant is called a **"Beacon."** When a Cobalt Strike Beacon is running on a host, it provides the attacker with a stable, stealthy C2 channel for data exfiltration, lateral movement, and deploying further tools like Mimikatz for credential theft.

The presence of any of these on a network indicates that an attacker has already achieved initial access and is now in the "post-exploitation" phase, which is far more dangerous. In this case, the filename `cobaltstrike_shellcode.exe` explicitly points to Cobalt Strike.

### 2. Malware Analysis

Threat intelligence confirmed the file is a well-known malicious payload.
*   **VirusTotal:** The hash `24d99ba5654cdf31141c66fd9417b7e0` was flagged as malicious by **66 security vendors**, with many identifying it specifically as related to Cobalt Strike. VirusTotal's behavioral analysis also provided a list of C2 servers the malware is known to contact.
    <img width="1782" height="849" alt="image" src="https://github.com/user-attachments/assets/d4a115a6-5a2e-4a75-9c4e-09b1d91ad2bb" />

### 3. Confirmation of Execution and Successful C2 Communication

The investigation confirmed a full compromise by correlating endpoint and network logs.
*   **Endpoint Execution:** Endpoint security logs show that the process `cobaltstrike_shellcode.exe` was successfully executed on the host "Alex - HP." The `Device Action: Allowed` from the SIEM alert corroborates that security controls did not prevent the initial execution.
    <img width="1166" height="678" alt="image" src="https://github.com/user-attachments/assets/850afc1f-6274-4ad7-a82d-fc8457ad4052" />
*   **Network C2 Connection:** Network logs show a successful outbound connection from the victim host `172.16.17.55` to the IP address `120.79.181.138`.
    <img width="1160" height="231" alt="image" src="https://github.com/user-attachments/assets/f90dd136-0599-4f84-a729-ce5bc0b498f0" />
*   **Correlation:** This IP address (`120.79.181.138`) is one of the C2 servers identified by VirusTotal for this exact malware hash. The sequence of **execution followed by an outbound connection to a known C2 server** is definitive proof of a successful Cobalt Strike Beacon implant.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, Network Logs, VirusTotal
*   **Skills Demonstrated:** Post-Exploitation Framework Analysis (Cobalt Strike), C2 Traffic Identification, Log Correlation.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Malicious.** The file is a Cobalt Strike Beacon.
*   **Was C2 Requested?** **Yes, Accessed.** The host is actively communicating with an attacker's C2 server.
*   **Was Malware Quarantined?** **No.** The `Device Action` was `Allowed`.
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC139 was a **true positive** for a critical host compromise. An attacker has successfully deployed a Cobalt Strike Beacon on the "Alex - HP" workstation, giving them persistent, interactive control over the system. The host must be considered a launch point for further attacks into the network, such as ransomware deployment or data theft.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host Immediately:** Disconnect the host **Alex - HP** (172.16.17.55) from the network to sever the active C2 connection. This is the highest priority.
2.  **CREDENTIALS - Disable and Reset:** Immediately disable the `Alex` user account in Active Directory. The user's credentials must be considered compromised and should be reset after the investigation. Invalidate all active sessions.
3.  **ESCALATE:** Immediately escalate this incident to the Tier 2/Incident Response (IR) team for full forensic analysis.
4.  **INVESTIGATION:** The IR team must assume the attacker has been active since the time of infection. The investigation should focus on identifying signs of credential dumping (e.g., Mimikatz), lateral movement attempts, and data staging or exfiltration.
5.  **BLOCK INDICATORS:** Immediately block all C2 IP addresses identified by VirusTotal (`120.79.181.138`, `185.125.190.26`, etc.) at the network firewall. Add the file hash (`24d99ba5654cdf31141c66fd9417b7e0`) to the EDR blocklist.
6.  **RECOVERY:** The compromised host cannot be trusted and must be wiped and re-imaged from a known-good source.








