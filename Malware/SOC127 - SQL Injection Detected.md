# SOC127 - SQL Injection Detected

## Executive Summary

On March 7, 2024, the Security Operations Center (SOC) received an alert for a SQL Injection attack against **WebServer1000** (172.16.20.12). The investigation confirmed a successful, automated attack originating from the known malicious IP address **118.194.247.28**. Log analysis revealed numerous requests with various SQL injection payloads and a User-Agent string identifying the attack tool as **sqlmap**. The server consistently responded with an **HTTP 200 OK** status and a non-zero response size, indicating that the malicious queries were executed and data was successfully exfiltrated. The web server must be considered fully compromised. This is a **True Positive** critical incident requiring immediate escalation.

## Incident Details

The initial alert was triggered by a URL containing a complex, multi-stage injection payload:

<img width="901" height="596" alt="image" src="https://github.com/user-attachments/assets/ec187fc1-1a28-4093-bfc1-f73dfcc7d75c" />

| | |
| :--- | :--- |
| **Date of Incident**| March 7, 2024 |
| **Source IP Address**| 118.194.247.28 |
| **Destination Host**| WebServer1000 (172.16.20.12) |
| **Attack Type**| SQL Injection (Automated via sqlmap) |
| **Case Link**| *(Case link not provided)* |

## Investigation and Analysis

### 1. Log Analysis and Identification of Attack Tool

A review of the web server logs for the source IP `118.194.247.28` showed a high volume of GET requests with complex, URL-encoded SQL payloads.

<img width="1469" height="698" alt="image" src="https://github.com/user-attachments/assets/e5ffa605-13a8-4ef7-935d-54f797a906f7" />

Analysis of the raw logs provided the most critical piece of evidence: the User-Agent string. In every malicious request, the User-Agent was `sqlmap/1.7.2#stable (https://sqlmap.org)`. `sqlmap` is a popular open-source penetration testing tool that automates the process of detecting and exploiting SQL injection vulnerabilities. This confirms the attack was automated and systematic.

<img width="647" height="345" alt="image" src="https://github.com/user-attachments/assets/8ea9aaba-97e5-43f2-a331-96da6314551e" />
<img width="645" height="350" alt="image" src="https://github.com/user-attachments/assets/b7443d9a-e4ad-4556-9979-48105037535f" />
<img width="634" height="235" alt="image" src="https://github.com/user-attachments/assets/e55f6463-257e-4427-a4af-740a8a0ac8cd" />

### 2. Confirmation of Success

The attack was confirmed as successful based on the server's responses:
*   **HTTP Response Status: 200 OK:** This code indicates that the server successfully processed the requests, including the injected SQL commands, without error.
*   **HTTP Response Size: 865:** A consistent, non-zero response size strongly suggests that data was returned in the response body. This is how `sqlmap` exfiltrates information from the database.
*   **Device Action: Allowed:** The alert confirms that the malicious requests were not blocked by any inline security devices like a WAF.

### 3. Threat Intelligence

The source IP `118.194.247.28` was checked against public threat intelligence databases, confirming its malicious reputation.
*   **VirusTotal:** 9 security vendors flagged the IP as malicious.
    <img width="1651" height="713" alt="image" src="https://github.com/user-attachments/assets/6c4f71d4-f574-4c9b-b153-9faf8d463e43" />
*   **AbuseIPDB:** The IP has over 4,000 reports
    <img width="1520" height="755" alt="image" src="https://github.com/user-attachments/assets/2a4b682d-7c64-4b65-87f9-8a977be5d81e" />

## Skills and Tools Utilized

*   **Tools Used:** SIEM, Log Management, VirusTotal, AbuseIPDB
*   **Skills Demonstrated:** SQL Injection Analysis, Log Correlation, Payload Deconstruction, Threat Intelligence.

## Playbook Solution: Incident Classification

*   **Is Traffic Malicious?** **Yes.** It is an automated SQL injection attack from a known-bad IP.
*   **What Is The Attack Type?** **SQL Injection.**
*   **Was the Attack Successful?** **Yes.** The server returned 200 OK responses with data.
*   **Do You Need Tier 2 Escalation?** **Yes.** A confirmed data exfiltration and server compromise requires immediate escalation.
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC127 was a **true positive** for a successful, automated SQL injection attack. The attacker used the `sqlmap` tool to exploit a vulnerability on **WebServer1000** and successfully exfiltrated data. The server's database and potentially the underlying operating system are compromised.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host Immediately:** Disconnect **WebServer1000** (172.16.20.12) from the network to prevent further data exfiltration, C2 communication, or lateral movement.
2.  **ESCALATE - Activate Full Incident Response Protocol:** Immediately escalate to the Tier 2/Incident Response (IR) team for forensic analysis.
3.  **INVESTIGATION:** The IR team must determine the full extent of the data breach. This includes identifying which databases and tables were accessed and what data was exfiltrated. They must also investigate if the attacker escalated privileges from the database to the OS level (as suggested by payloads attempting to run `xp_cmdshell`).
4.  **CREDENTIAL ROTATION:** All credentials, API keys, and service account passwords stored in the compromised database must be considered stolen and must be rotated immediately.
5.  **ERADICATION & RECOVERY:** The web application must be taken offline. The vulnerability must be identified and patched. The server should be rebuilt from a known-good image.
6.  **BLOCK INDICATORS:** Block the attacker's IP address `118.194.247.28` at the network perimeter.



