# 	SOC118 - Internal Port Scan Activity

## Executive Summary

On February 6, 2021, the Security Operations Center (SOC) received an alert for an internal port scan originating from the host **Katie** (172.16.17.35). The investigation confirmed that the user was running **Zenmap** (the GUI for the Nmap network scanner), a tool not authorized for general use. The activity was directed at the host **RichardPRD** (172.16.17.45). Log analysis confirmed that the port scan attempt was successfully **Blocked** by internal security controls. While the tool itself is not malware, its use for unauthorized network scanning is a serious security policy violation and a common tactic for lateral movement. The alert is a **True Positive** for unauthorized reconnaissance and requires escalation to investigate the user's intent.

## Incident Details

The initial alert was triggered by a high volume of connection attempts, characteristic of a port scan:

<img width="1539" height="539" alt="image" src="https://github.com/user-attachments/assets/c03684b3-2370-4495-a566-c9f81baf3237" />

| | |
| :--- | :--- |
| **Date of Incident**| February 6, 2021 |
| **Source Host**| Katie (172.16.17.35) |
| **Destination Host**| RichardPRD (172.16.17.45) |
| **Tool Used**| Zenmap / Nmap (`empty.exe`) |
| **File Hash (MD5)**| 0a1ca6261fdb9671495be58a5691b21f |
| **Attack Type**| Internal Reconnaissance / Port Scan |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/51))* |

## Investigation and Analysis

### 1. Alert Context: Internal Reconnaissance as a Threat

The rule `SOC118 - Internal Port Scan Activity` is designed to detect lateral movement and internal reconnaissance. After an attacker gains an initial foothold on one machine, they often scan the internal network to identify other live hosts, open ports, and vulnerable services. Detecting this activity early is critical to stopping an attacker before they can pivot to more sensitive systems.

### 2. Tool Identification and Analysis

The investigation began by identifying the file `empty.exe` associated with the activity.
*   **Threat Intelligence:** VirusTotal analysis of the hash `0a1ca6261fdb9671495be58a5691b21f` showed **zero detections**. Crucially, the file details identify it as **Zenmap**, the official graphical user interface for the powerful Nmap network scanner.
    <img width="1768" height="880" alt="image" src="https://github.com/user-attachments/assets/82faa429-1d78-47e3-a9b5-4dc71adae140" />
*   **Endpoint Confirmation:** Endpoint security logs confirm the file path as `C:/Program Files (x86)/Nmap/empty.exe`, which is a default installation path for Nmap components.
*   **Conclusion:** The tool is not malware in the traditional sense, but a legitimate (though powerful and dual-use) network administration tool. The alert is valid because the *activity* (unauthorized scanning) is malicious/prohibited, regardless of the tool's legitimacy.

### 3. Log Analysis: Confirmation of Attempt and Prevention

A review of the network and firewall logs confirmed the activity and, most importantly, the outcome.
*   **Activity Confirmation:** Logs show a high volume of connection attempts from the source `172.16.17.35` (Katie) to the destination `172.16.17.45` (RichardPRD) across many different ports.
    <img width="1550" height="725" alt="image" src="https://github.com/user-attachments/assets/1a945805-4c60-45ca-911d-4205c7668823" />
*   **Prevention Confirmation:** The logs clearly show that the **Firewall Action** for these connections was **Blocked**. This proves that while the scan was attempted, the internal network segmentation or host-based firewall successfully prevented it from completing.
*   <br>
    <img width="645" height="164" alt="image" src="https://github.com/user-attachments/assets/04e114e9-4689-409a-a6ae-74f66a2e0cbd" />

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, Firewall Logs, VirusTotal
*   **Skills Demonstrated:** Internal Reconnaissance Analysis, Log Correlation, Tool Identification, False Positive vs. True Positive Triage.

## Playbook Solution: Incident Classification

*   **Is Traffic Malicious?** **Yes.** Unauthorized internal network scanning is considered hostile activity.
*   **What Is The Attack Type?** **Internal Reconnaissance / Port Scan.**
*   **Was the Attack Successful?** **No.** The activity was detected and blocked by the firewall.
*   **Do You Need Tier 2 Escalation?** **Yes.** This is a serious policy violation and a potential insider threat or indicator of a compromised account that requires investigation.
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC118 was a **true positive** for an *attempted* internal port scan. The user `Katie` ran the Nmap/Zenmap tool from their workstation to scan another host on the network. While security controls successfully blocked the scan, the initiation of such an activity is a significant security event that must be investigated to determine the user's intent.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host:** As a precaution, the host **Katie** (172.16.17.35) should be isolated from the network. This is critical in case the user's account is compromised and being used by an external attacker.
2.  **ESCALATE:** Immediately escalate this incident to the user's manager and the appropriate HR or Insider Threat team. The user's intent must be determined.
3.  **INVESTIGATION:** A two-pronged investigation is required:
    *   **Technical:** The IR team should analyze the host "Katie" to determine how and when Nmap was installed and to look for any other signs of compromise.
    *   **Human:** The appropriate team (e.g., management, HR) must interview the user `Katie` to understand why they were running a network scanner.
4.  **REMEDIATION:**
    *   **Unauthorized Software:** The Nmap suite should be uninstalled from the user's workstation.
    *   **Policy Enforcement:** Implement application control policies (e.g., AppLocker) to prevent non-privileged users from running network scanning tools or other unauthorized software.


