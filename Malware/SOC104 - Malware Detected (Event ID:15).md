# SOC104 - Malware Detected (Event ID:15)

## Executive Summary

On September 18, 2020, the Security Operations Center (SOC) received a critical alert for malware detected on the host **Katie** (172.16.17.35). The investigation confirmed the execution of a malicious file, `rfq 9-18-2020-docx.r00.exe`, which was definitively identified by multiple threat intelligence platforms as a powerful **information stealer**. The malware's filename, using double extensions (`.docx.r00.exe`), is a classic social engineering trick to deceive the user into believing it is a document. The `Device Action: Allowed` status and endpoint logs confirming the process execution mean the malware ran successfully. Given the malware's extensive data theft capabilities, the host is fully compromised. This is a **True Positive** critical incident.

## Incident Details

The initial alert was triggered by the detection of a known malicious executable:

<img width="1447" height="519" alt="image" src="https://github.com/user-attachments/assets/384c12b0-4626-45c6-b067-a615839bd2fb" />

| | |
| :--- | :--- |
| **Date of Incident**| September 18, 2020 |
| **Source Host**| Katie (172.16.17.35) |
| **Malware File**| `rfq 9-18-2020-docx.r00.exe` |
| **File Hash (MD5)**| 141812f77bdef659d1bc5c1403c5e094 |
| **Attack Type**| Information Stealer / Trojan |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/15))* |

## Investigation and Analysis

### 1. Alert Triage and Filename Analysis

The investigation began by analyzing the filename `rfq 9-18-2020-docx.r00.exe`.
*   **Social Engineering:** The name is designed to look like a legitimate business document ("Request for Quote" from today's date). This is a common lure, especially in corporate environments.
*   **Double Extension:** The use of multiple extensions (`.docx.r00.exe`) is a classic trick. On a default Windows system that hides known file extensions, this file might appear to the user as `rfq 9-18-2020-docx.r00`. The user, thinking it is a document or part of a multi-part archive, double-clicks it, but the operating system correctly executes it as an `.exe` file.

### 2. Malware Analysis

Threat intelligence provided a definitive identification and a comprehensive list of the malware's dangerous capabilities.
*   **Threat Intelligence (VirusTotal):** The file hash was flagged as malicious by **58 out of 72 security vendors**, confirming it is a well-known threat.
    <img width="1628" height="890" alt="image" src="https://github.com/user-attachments/assets/41b59b99-f7a0-48c2-bf21-d126bdc65a40" />
*   **Dynamic Analysis (Hybrid Analysis):** A sandbox run returned a **100/100 malicious score** and detailed its extensive information-stealing capabilities:
    *   **Spyware/Stealer:** Actively attempts to steal credentials from web browsers, email clients (Mail), FTP clients (FileZilla), and secure shell clients (Putty/WinSCP).
    *   **Persistence:** It establishes persistence by modifying registry autorun keys and creating scheduled tasks.
    *   **Defense Evasion:** It employs anti-virtualization techniques and attempts to hide its tracks after download.
    *   **DNS Hijacking:** It has the capability to write to the `hosts` file, a technique for redirecting traffic.
    <img width="1597" height="794" alt="image" src="https://github.com/user-attachments/assets/6678938d-514d-4313-8c6c-7a9ed0c8486e" />

### 3. Confirmation of Successful Execution

The investigation confirmed that the user executed the malware and the host was compromised.
*   **Execution Allowed:** The SIEM alert clearly states the `Device Action` was `Allowed`, meaning the EDR/antivirus did not block the file from running.
*   **Endpoint Logs (The "Smoking Gun"):** EDR logs show the process `rfq 9-18-2020-docx.r00.exe` running on the host "Katie." This confirms the user was tricked into opening the file, and the malware successfully executed.
    <img width="976" height="299" alt="image" src="https://github.com/user-attachments/assets/88d84f9a-1667-4131-ac0b-f6f2aa28b15c" />

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, VirusTotal, Hybrid Analysis
*   **Skills Demonstrated:** Malware Analysis (Infostealer), Social Engineering Triage, Log Correlation, TTP Recognition.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Malicious.** The file is a confirmed multi-functional information stealer.
*   **Was the Attack Successful?** **Yes.** The malware was allowed to execute on the endpoint.
*   **Do You Need Tier 2 Escalation?** **Yes.** A successful infostealer infection is a critical incident.
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC104 was a **true positive** for a critical infection by a potent information stealer. The host **Katie** is fully compromised. Due to the malware's extensive capabilities, it must be assumed that all credentials (browser, email, FTP, etc.) stored on or entered into the machine since the time of infection have been stolen.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host Immediately:** Disconnect the host **Katie** (172.16.17.35) from the network to prevent the malware from exfiltrating stolen data and to sever any C2 connection.
2.  **CREDENTIALS - Assume Full Compromise:**
    *   Immediately disable the `Katie` user account and force a password reset.
    *   This is not enough. All other personal and corporate credentials that may have been stored in the user's browser, email client, or other applications on that machine must be considered stolen and must be reset.
3.  **ESCALATE:** Immediately escalate this incident to the Tier 2/Incident Response (IR) team for a full-scale response.
4.  **INVESTIGATION:** The IR team must:
    *   Analyze network traffic from the host to identify the C2 server IP(s) and block them.
    *   Determine the initial access vector (this was almost certainly a phishing email) and hunt for it in other mailboxes.
    *   Remove the persistence mechanisms (registry keys, scheduled tasks) created by the malware.
5.  **RECOVERY:** The compromised host cannot be trusted and must be wiped and re-imaged from a known-good source.
6.  **BLOCK INDICATORS:** Add the file hash `141812f77bdef659d1bc5c1403c5e094` to the EDR blocklist.




























