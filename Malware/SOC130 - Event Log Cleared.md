# SOC130 - Event Log Cleared


## Executive Summary

On February 21, 2021, the Security Operations Center (SOC) received an alert for a "Event Log Cleared" event on the **Exchange Server** (172.16.20.3), executed by `powershell.exe`. An investigation was launched to determine if this was a defense evasion technique used by an attacker to cover their tracks. Analysis confirmed that the `powershell.exe` binary was the legitimate, signed Microsoft executable. A thorough review of the endpoint's security logs for the period preceding the event revealed **no signs of anomalous or malicious activity**. The absence of any precursor attack indicators strongly suggests this was a benign administrative action, not a malicious one. The alert is therefore classified as a **False Positive**.

## Incident Details

The initial alert was triggered by an action associated with defense evasion:

<img width="1559" height="538" alt="image" src="https://github.com/user-attachments/assets/6cd3cd81-0e8a-41c0-8356-9c2ad68d708e" />

| | |
| :--- | :--- |
| **Date of Incident**| February 21, 2021 |
| **Source Host**| Exchange Server (172.16.20.3) |
| **Process Name**| powershell.exe |
| **File Hash (MD5)**| 7353f60b1739074eb17c5f4dddefe239 |
| **Suspected Tactic**| Defense Evasion (MITRE ATT&CK T1070.001) |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/64))* |

## Investigation and Analysis

### 1. Alert Context: Why "Event Log Cleared" is Suspicious

The rule `SOC130 - Event Log Cleared` is designed to detect a common defense evasion technique. After an attacker gains access to a system and performs malicious actions, they will often clear the security, system, and application event logs to erase evidence of their presence and activities. This tactic is tracked under **MITRE ATT&CK T1070.001 - Clear Windows Event Logs**. Therefore, any instance of logs being cleared, especially on a critical server, is automatically considered suspicious and requires investigation.

### 2. File and Process Analysis

The first step was to verify the integrity of the tool used to perform the action.
*   **Threat Intelligence:** The MD5 hash `7353f60b1739074eb17c5f4dddefe239` was checked against VirusTotal and Any.Run.
    *   VirusTotal confirmed the file is the legitimate, Microsoft-signed `powershell.exe` with zero detections.
        <img width="1744" height="745" alt="image" src="https://github.com/user-attachments/assets/e8a75930-90c5-4510-bf03-40148da7cc86" />
    *   Any.Run marked the process as "suspicious" but not overtly malicious, which is expected for a powerful tool like PowerShell.
        <img width="1842" height="651" alt="image" src="https://github.com/user-attachments/assets/817263c7-3be2-4c12-8cef-2449bb910980" />
*   **Conclusion:** The action was performed by the genuine PowerShell application, not a malicious imposter. If this were a malicious event, it would be a "Living-off-the-Land" (LOLBin) attack, where an attacker uses legitimate system tools for hostile purposes.

### 3. Searching for Precursor Malicious Activity

The deciding factor in determining if a log-clearing event is malicious is the context. An attacker clears logs to hide something. Therefore, the most critical investigation step is to look for that "something" *before* the logs were cleared.
*   A thorough review of the endpoint security logs for the **Exchange Server** was conducted for the hours and days leading up to the 07:23 PM alert.
*   The investigation searched for any signs of compromise, such as:
    *   Anomalous process executions.
    *   Suspicious network connections.
    *   Successful logins from unusual sources.
    *   Execution of other known malicious tools or commands.

The endpoint logs showed no such precursor activity.
<img width="1189" height="456" alt="image" src="https://github.com/user-attachments/assets/c24f0aab-9319-4dfc-9374-0007f9f0c0ab" />

Without any preceding malicious event, there is no evidence that an attacker had a reason to clear the logs. The most logical conclusion is that the action was performed for a benign reason, such as routine maintenance by a system administrator.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, VirusTotal, Any.Run
*   **Skills Demonstrated:** False Positive Analysis, Log Analysis, LOLBin Triage, Understanding of Defense Evasion Techniques.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Non-malicious.** The file is the legitimate `powershell.exe`.
*   **Was Malware Quarantined?** **No.** The file is a core system component.
*   **Is Traffic Malicious?** **No.** The action was suspicious, but the intent was not malicious.
*   **Incident Classification:** **False Positive.**

## Conclusion and Recommendations

The alert for SOC130 was a **false positive**. The SIEM rule correctly identified a high-risk action (clearing of event logs), but the investigation determined that the action was performed by a legitimate system tool in the absence of any other indicators of compromise. This suggests the activity was likely part of a planned administrative task.

**Recommendations:**

1.  **Close Alert:** The alert should be closed as a False Positive, with notes detailing the investigation and findings.
2.  **Verify Administrative Action:** As a final step, it is best practice to correlate this event with the system administrator responsible for the **Exchange Server**. A quick check can confirm if they were performing maintenance at this time. This helps build a baseline of normal administrative activity.
3.  **Rule Tuning Consideration:** If log clearing is a frequent and documented maintenance procedure on this server, consider creating a temporary suppression rule or a tuning that lowers the severity of this alert specifically for this host when performed by a known administrator account.
