# SOC131 - Reverse TCP Backdoor Detected
## Executive Summary

On March 1, 2021, the Security Operations Center (SOC) detected a reverse TCP backdoor on the host **MikeComputer** (172.16.17.14). The investigation confirmed that a malicious batch file, `msi.bat`, was executed. Static analysis of this file revealed a heavily obfuscated, single-line Python command designed to establish a reverse shell to a command-and-control (C2) server at **81.68.99.93**. The endpoint security solution successfully detected this malicious activity, and the alert shows a **Device Action** of **Cleaned**, indicating the threat was neutralized before it could establish a stable connection or cause further damage. This is a **True Positive** for a real, albeit prevented, threat.

## Incident Details

The initial alert was triggered by behavior indicative of a reverse shell:

<img width="1518" height="592" alt="image" src="https://github.com/user-attachments/assets/5e946e6d-b554-48c6-9007-484f8b2387ee" />

| | |
| :--- | :--- |
| **Date of Incident**| March 1, 2021 |
| **Attacker C2 IP**| 81.68.99.93 |
| **Destination Host**| MikeComputer (172.16.17.14) |
| **Malware File**| msi.bat |
| **File Hash (MD5)**| 3dc649bc1be6f4881d386e679b7b60c8 |
| **Attack Type**| Reverse Shell / Backdoor |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/67))* |

## Investigation and Analysis

### 1. Alert Context: Reverse Shells

A "reverse TCP backdoor," commonly known as a reverse shell, is a critical threat. Instead of an attacker connecting *in* to a victim's machine (which is often blocked by firewalls), the victim machine is tricked into connecting *out* to the attacker's server. This outbound connection bypasses many firewall rules and provides the attacker with an interactive command prompt (`cmd.exe`) on the compromised host, giving them full control.

### 2. Malware Analysis

*   **Threat Intelligence:** VirusTotal confirmed the `msi.bat` file was malicious, with 9 vendors flagging it. The "Code insights" section correctly identified its purpose: to create a socket connection and pipe the input/output of `cmd.exe` through it, effectively creating a reverse shell.
    <img width="1809" height="886" alt="image" src="https://github.com/user-attachments/assets/25a2f0de-0b5f-46ad-b116-ce4de1c9169a" />

*   **Static Analysis:** Analysis of the batch file revealed a single, highly obfuscated command designed to be executed by the Python interpreter (`C:\Python27\python.exe`).
    <img width="1530" height="863" alt="image" src="https://github.com/user-attachments/assets/fd9e30e2-cdf2-41c5-8491-a15c05e1f3c6" />

    While the code is deliberately made unreadable, its core function, as identified by threat intelligence, is to:
    1.  Import necessary Python libraries (`socket`, `subprocess`, `threading`).
    2.  Create a TCP socket connection to the attacker's C2 server: **`81.68.99.93`** on port **`443`**. Using port 443 (HTTPS) is a common tactic to blend in with normal encrypted web traffic.
    3.  Launch a `cmd.exe` process on the victim machine.
    4.  Create two threads to continuously pipe data: one to send command output from `cmd.exe` to the C2, and one to receive commands from the C2 and feed them into `cmd.exe`.

### 3. Confirmation of Successful Prevention

The investigation confirmed that the security controls on the endpoint successfully prevented the compromise.
*   **Device Action: Cleaned:** The initial alert clearly states that the EDR/antivirus agent took a "Cleaned" action. This indicates the malicious batch file and any related processes were terminated and removed.
*   **Endpoint Log Verification:** A review of the process history on the host "MikeComputer" shows no execution of `msi.bat` or any subsequent suspicious Python processes. This confirms the EDR agent's "Cleaned" action was successful.
    <img width="1449" height="606" alt="image" src="https://github.com/user-attachments/assets/68f0a799-eeab-4201-a9b2-643de1ff1e05" />
*   **Network Log Verification:** A search of the network logs confirmed that no outbound connection was ever established from the host `172.16.17.14` to the C2 server `81.68.99.93`. This is a critical finding, proving the backdoor was stopped before it could become active.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, VirusTotal, Static Analysis
*   **Skills Demonstrated:** Reverse Shell Analysis, Malware Triage, Log Correlation, Analysis of Obfuscated Code.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Malicious.** The file is an obfuscated Python reverse shell.
*   **Was Malware Quarantined/Cleaned?** **Yes.** The device action was "Cleaned."
*   **Was C2 Requested?** **No, Not Accessed.** The malware was stopped before it could make an outbound connection.
*   **Incident Classification:** **True Positive.** (A real threat was detected and stopped).

## Conclusion and Recommendations

The alert for SOC131 was a **true positive**. A malicious batch file designed to establish a reverse shell was executed on "MikeComputer." The endpoint security solution successfully detected and cleaned the threat, preventing the backdoor from connecting to its C2 server and stopping a full host compromise.

**Recommendations:**

1.  **Acknowledge Prevention:** Note the successful detection and remediation by the EDR/antivirus solution.
2.  **Verify Containment:** While the EDR reported the threat as "Cleaned," a best practice is to have a Tier 2 analyst or system administrator run a full, updated AV scan on the host to ensure no remnants of the malware exist.
3.  **Investigate Initial Access:** The most critical follow-up action is to determine *how* `msi.bat` was delivered to and executed on the host. An interview with the user (`Mike`) is necessary to investigate potential phishing emails, malicious web downloads, or other vectors.
4.  **BLOCK INDICATORS:** Proactively block the C2 IP address `81.68.99.93` at the network firewall. Add the file hash (`3dc649bc1be6f4881d386e679b7b60c8`) to the EDR blocklist to prevent execution on other hosts.

