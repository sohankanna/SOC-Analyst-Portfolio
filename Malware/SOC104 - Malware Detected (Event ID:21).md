# SOC104 - Malware Detected (Event ID:21)

## Executive Summary

On October 20, 2020, the Security Operations Center (SOC) received a critical alert for malware detected on the host **GeorgProd** (172.16.17.41). The investigation confirmed that a malicious document, `5919600.doc`, was executed on the system. Threat intelligence platforms definitively identified the file as a potent malware with capabilities for persistence, evasion, and data theft. The `Device Action: Allowed` status confirms the malware ran successfully, and network logs provide a "smoking gun" showing an active command-and-control (C2) connection to a known malicious domain. The host is fully compromised. This is a **True Positive** critical incident.

## Incident Details

The initial alert was triggered by the detection of a known malicious file on an endpoint:

<img width="1447" height="519" alt="image" src="https://github.com/user-attachments/assets/dcd6e4dd-4d14-47e7-81f4-55cc77a70402" />

| | |
| :--- | :--- |
| **Date of Incident**| October 20, 2020 |
| **Source Host**| GeorgProd (172.16.17.41) |
| **Malware File**| `5919600.doc` |
| **File Hash (MD5)**| F46B0C39FCFDF4C0426C9276A2BB48C6 |
| **Attacker C2 Domain**| `www.drleenasreedhar.com` |
| **Attack Type**| Malware / Trojan |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/21))* |

## Investigation and Analysis

### 1. Malware Analysis

A deep analysis of the `5919600.doc` file confirmed its highly malicious nature.
*   **Threat Intelligence (VirusTotal):** The file hash was flagged as malicious by **46 out of 70 security vendors**, providing a definitive confirmation of the threat.
    <img width="1698" height="780" alt="image" src="https://github.com/user-attachments/assets/a5cc540a-cf4f-4f90-8a66-dd8d3202e968" />
*   **Dynamic Analysis (Hybrid Analysis):** A sandbox run returned a **100/100 malicious score** and provided a detailed breakdown of its behaviors. Critically, it noted the malware's capability to establish persistence, use evasive techniques, and, most importantly, its **Network Behavior**, where it was observed contacting 7 different domains.
    <img width="1563" height="734" alt="image" src="https://github.com/user-attachments/assets/a42919f0-2cd1-4f53-b976-4ae31edce995" />
    <img width="1231" height="504" alt="image" src="https://github.com/user-attachments/assets/60db692f-3836-4067-bfcc-f475f626a691" />

### 2. Confirmation of Execution and C2 Communication

The investigation confirmed a full compromise by correlating the alert data with endpoint and network logs.
*   **Execution Allowed:** The SIEM alert clearly states the `Device Action` was `Allowed`, meaning the EDR/antivirus did not block the malicious document from running its payload.
*   **Endpoint Logs:** EDR logs confirm that the process `5919600.doc` was executed on the host "GeorgProd."
*   **C2 Connection (The "Smoking Gun"):** Network logs provide the definitive proof of compromise. A log entry shows a successful outbound HTTP connection from the victim host to `http://www.drleenasreedhar.com/wordpress/x/`. This domain was one of the C2 servers identified in the Hybrid Analysis report. This confirms the malware successfully "phoned home" and is likely receiving commands from or exfiltrating data to the attacker.
    <img width="980" height="362" alt="image" src="https://github.com/user-attachments/assets/e76a333f-5a15-48c0-9d5d-580b78ad0eca" />

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, Network Logs, VirusTotal, Hybrid Analysis
*   **Skills Demonstrated:** Malware Triage, C2 Traffic Identification, Log Correlation, Attack Chain Reconstruction.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Malicious.** The file is a confirmed malware dropper.
*   **Was the Attack Successful?** **Yes.** The malware executed and established a C2 connection.
*   **Do You Need Tier 2 Escalation?** **Yes.** A confirmed C2 beacon from a host is a critical incident.
*   **Incident Classification:** **True Positive.**

## Conclusion and Recommendations

The alert for SOC104 was a **true positive** for a critical malware infection. An attacker successfully tricked a user into running a malicious document, which then established a command-and-control channel to an attacker's server. The host **GeorgProd** is fully compromised and poses an active threat to the network.

**Recommendations:**

1.  **CONTAINMENT - Isolate Host Immediately:** Disconnect the host **GeorgProd** (172.16.17.41) from the network to sever the active C2 connection and prevent lateral movement.
2.  **CREDENTIALS - Disable and Reset:** Immediately disable the user's account and reset their password.
3.  **ESCALATE:** Immediately escalate this incident to the Tier 2/Incident Response (IR) team for a full forensic investigation.
4.  **INVESTIGATION:** The IR team must perform a full forensic analysis to determine the malware's capabilities and what actions the attacker took after gaining control. They must also hunt for the initial access vector (likely a phishing email).
5.  **RECOVERY:** The compromised host cannot be trusted and must be wiped and re-imaged from a known-good source.
6.  **BLOCK INDICATORS:**
    *   **Hash:** Add the file hash `F46B0C39FCFDF4C0426C9276A2BB48C6` to the EDR blocklist.
    *   **Domains:** Block all C2 domains identified in the Hybrid Analysis report, including `www.drleenasreedhar.com`, at the network firewall and web proxy.


















