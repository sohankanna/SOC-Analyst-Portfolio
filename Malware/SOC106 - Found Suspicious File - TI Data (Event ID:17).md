# 	SOC106 - Found Suspicious File - TI Data (Event ID:17)

## Executive Summary

On September 22, 2020, the Security Operations Center (SOC) received an alert for a suspicious file, `ChromeSetup.exe`, on the host **ChanProd** (172.16.17.150). The alert was triggered by a threat intelligence (TI) match. However, a deep investigation confirmed the file is the legitimate, official Google Chrome installer. Static analysis from VirusTotal showed zero detections and confirmed its authenticity. Dynamic analysis from Hybrid Analysis, while flagging some behaviors as "malicious" or "suspicious," revealed actions that are entirely consistent with a legitimate, complex software installation process (e.g., creating suspended processes for updates, writing to Program Files, registering services). The endpoint security solution **Cleaned** the file, but this was an incorrect action based on a false positive. The alert is a **False Positive**.

## Incident Details

The initial alert was triggered by a threat intelligence signature match:

<img width="1447" height="469" alt="image" src="https://github.com/user-attachments/assets/dcd6e4dd-4d14-47e7-81f4-55cc77a70402" />

| | |
| :--- | :--- |
| **Date of Incident**| September 22, 2020 |
| **Source Host**| ChanProd (172.16.17.150) |
| **File Name**| ChromeSetup.exe |
| **File Hash (MD5)**| 1430438f19e3d3e2b375d127c68254ab |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/17))* |

## Investigation and Analysis

### 1. Alert Triage and Threat Intelligence

The investigation began by analyzing the file that triggered the alert.
*   **Threat Intelligence (VirusTotal):** A check of the file hash on VirusTotal showed **zero detections** from all security vendors. The file details confirmed it is a legitimate, signed Google installer. This is a very strong initial indicator of a false positive.
    <img width="1698" height="865" alt="image" src="https://github.com/user-attachments/assets/321a8853-70da-444f-aacc-d47002fe7f87" />
*   **Dynamic Analysis (Hybrid Analysis):** The sandbox analysis returned a `100/100` malicious score, which appears to be the source of the initial TI-based alert. However, a manual review of the "malicious indicators" is crucial:
    *   **"Creates a process in suspended mode":** Legitimate installers, especially updaters like Google's, do this to replace files that are in use.
    *   **"Loads the task scheduler COM API":** Google Update creates scheduled tasks to check for new versions. This is normal behavior.
    *   **"Writes data to a remote process":** This is part of the installation and update mechanism.
    *   **"Spawns a lot of processes":** A complex installation like Google Chrome involves multiple components (updater, core browser, services), so spawning many processes is expected.

    The behaviors flagged as malicious are, in this context, all explainable and legitimate actions for the Google Chrome installer. The automated sandbox misinterpreted these dual-use TTPs.
    <img width="1618" height="739" alt="image" src="https://github.com/user-attachments/assets/350693bd-79d1-4147-b617-6ba995db7a80" />

### 2. Final Assessment

The evidence confirms that this was a benign event. A user was installing or updating Google Chrome. The SIEM rule, relying on a flawed TI feed from a sandbox that misinterpreted legitimate installer behavior, generated a false positive. The endpoint agent's action to "Clean" the file was incorrect and disruptive to the user.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, EDR, VirusTotal, Hybrid Analysis
*   **Skills Demonstrated:** False Positive Analysis, Contextual Triage, Differentiating Legitimate vs. Malicious Behavior, TTP Analysis.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Non-malicious.** The file is the legitimate Google Chrome installer.
*   **Incident Classification:** **False Positive.**

## Conclusion and Recommendations

The alert for SOC106 was a **false positive**. The investigation confirmed that the legitimate Google Chrome installer was incorrectly flagged as malicious by a threat intelligence source, likely due to an automated sandbox misinterpreting normal installer and updater behaviors.

**Recommendations:**

1.  **Close Alert:** The alert should be closed as a False Positive, with notes detailing the findings.
2.  **Remediate EDR Action:** If the EDR "Cleaned" (quarantined) the file, it should be restored. The user (`Chan`) should be contacted to inform them of the error and to assist with reinstalling Google Chrome if necessary.
3.  **Threat Intelligence Feed Review:** This incident highlights a flaw in the threat intelligence feed. The SOC should:
    *   Submit the file hash (`1430438f19e3d3e2b375d127c68254ab`) to the TI vendor as a false positive for review.
    *   Consider lowering the confidence score or alert severity for TI hits that originate solely from automated sandbox analysis without corroboration from other sources, especially for well-known software installers.
4.  **Whitelisting:** To prevent recurrence, create a whitelist exception in the EDR/AV policy for digitally signed executables from trusted publishers like "Google LLC."















