# SOC113 - Suspicious hh.exe Usage (Event ID:44)

## Executive Summary

On January 31, 2021, the Security Operations Center (SOC) received an alert for suspicious usage of `hh.exe` on the host **BillPRD** (172.16.17.47). The alert was triggered by the opening of the file `WinRAR.chm`. A thorough investigation confirmed that the file in question is the legitimate, official help file for the WinRAR application. The process used to open it, `hh.exe`, is the native Microsoft HTML Help Executable, which is the correct and intended application for `.chm` files. Threat intelligence analysis from multiple platforms confirmed the file is benign. The alert is therefore classified as a **False Positive**, where a SIEM rule misidentified a normal, benign Windows operation as malicious.

## Incident Details

The initial alert was triggered by the execution of a legitimate Windows binary that can also be used for malicious purposes:

<img width="1467" height="507" alt="image" src="https://github.com/user-attachments/assets/b590839f-d333-4539-8bce-30f91263a1b9" />

| | |
| :--- | :--- |
| **Date of Incident**| January 31, 2021 |
| **Source Host**| BillPRD (172.16.17.47) |
| **File Name**| WinRAR.chm |
| **File Hash (MD5)**| 07694464c25bac4ecdb365e928ffe1ff |
| **Suspected Tactic**| Signed Binary Proxy Execution (MITRE ATT&CK T1218.001) |
| **Case Link**| *([Case link](https://app.letsdefend.io/case-management/casedetail/sohankanna/44))* |

## Investigation and Analysis

### 1. Alert Context: `hh.exe` as a "Dual-Use" Tool (LOLBin)

The rule `SOC113 - Suspicious hh.exe Usage` is designed to detect a "living-off-the-land" (LOLBin) technique.
*   **Legitimate Use:** `hh.exe` is the Microsoft HTML Help Executable, a core component of Windows responsible for opening and displaying `.chm` (Compiled HTML Help) files, which are common for application help manuals.
*   **Malicious Use:** Attackers abuse `hh.exe` because it is a trusted, signed Microsoft binary. They can craft a malicious `.chm` file containing embedded scripts (JScript/VBScript). When a user opens this malicious file with `hh.exe`, the script can be executed, allowing the attacker to run arbitrary code on the victim's machine. This is a form of proxy execution that can bypass some security controls.

The SIEM rule likely triggered simply because `hh.exe` was used, without sufficient context to determine if the `.chm` file it was opening was malicious.

### 2. File and Threat Intelligence Analysis

The investigation focused on verifying the legitimacy of the `WinRAR.chm` file.
*   **Threat Intelligence (VirusTotal):** A check of the file hash `07694464c25bac4ecdb365e928ffe1ff` on VirusTotal showed **zero detections** from all security vendors. The file is identified as the legitimate WinRAR CHM help file.
    <img width="1670" height="837" alt="image" src="https://github.com/user-attachments/assets/17211588-3825-4e8e-8f7f-fe60449df634" />
*   **Dynamic Analysis (Hybrid Analysis):** The file was whitelisted and showed no malicious behavior in the sandbox environment, further confirming its benign nature.
    <img width="1853" height="682" alt="image" src="https://github.com/user-attachments/assets/8da6d26b-4ca5-4a06-90e5-d6921162a3bb" />
*   **Content Analysis:** Opening the `.chm` file reveals the standard, legitimate help and documentation page for the WinRAR application.
    <img width="795" height="585" alt="image" src="https://github.com/user-attachments/assets/7ffab7de-156c-47ae-9571-015e961d9108" />

### 3. Final Assessment

All evidence confirms this was a benign event. A user likely opened the help file for the WinRAR application. The `Device Action: Allowed` is the correct behavior for this legitimate action. The SIEM rule generated a false positive because it was too broad, flagging any use of `hh.exe` without considering the context or the reputation of the file being opened.

## Skills and Tools Utilized

*   **Tools Used:** SIEM, VirusTotal, Hybrid Analysis
*   **Skills Demonstrated:** False Positive Analysis, LOLBin Triage, Threat Intelligence Correlation, Contextual Analysis.

## Playbook Solution: Incident Classification

*   **Analyze Malware:** **Non-malicious.** The file is a legitimate application help file.
*   **Incident Classification:** **False Positive.**

## Conclusion and Recommendations

The alert for SOC113 was a **false positive**. The investigation confirmed that a user was performing a normal action—opening a help file—using the correct, legitimate Windows application. The alert was generated by a poorly tuned rule that lacked context.

**Recommendations:**

1.  **Close Alert:** The alert should be closed as a False Positive, with notes detailing the findings.
2.  **Rule Tuning:** This incident highlights a clear need for rule tuning to reduce alert fatigue. The SOC team should modify the `SOC113` rule to make it more intelligent. Instead of alerting on *any* `hh.exe` execution, the rule should look for more specific, high-fidelity indicators of malicious use, such as:
    *   `hh.exe` being spawned by an unusual parent process (e.g., `powershell.exe`, `wscript.exe`, or an Office application).
    *   `hh.exe` making outbound network connections.
    *   `hh.exe` opening a `.chm` file from a suspicious or uncommon location (like `%TEMP%` or a user's Downloads folder) with a low-reputation hash.


















